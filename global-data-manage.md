# 全局变量的管理

## 前言

> 在浏览器的环境下有一个全局变量：`window`。
若定义变量时，遗漏了`var`，此时声明的变量就变成了全局变量，自动挂载到`window`下，全局都可以通过`window`来访问，或者直接访问。

小程序的底层也是通过Web实现的，因此同样存在`window`对象，但是微信团队做了些处理：

![](images/global-window.png)

将`window`设置成`writable:false`。即我们无法任意声明全局变量。但前面的引言也说了，`window`下的属性，也是可以直接访问，因此也可以当做全局变量来看待，比如常用的`wx`、`global`。

## 问题

虽然`window`是只读的，但是`window`下的属性是可写的，比如`global`:

![](images/global-global.png)

因此常见的做法，就是将需要全局访问的变量都保存到`global`下，间接声明了全局变量。

全局变量的污染，在小团队里可能没什么感知，但是在一个大型的项目里，是非常常见的，一不小心就将别人声明的变量覆盖了。

另外如果放任注册全局变量的话，也可能会导致内存泄漏，最终导致用户闪退。